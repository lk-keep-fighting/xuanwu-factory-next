# 项目管理使用指南

## 简介

项目管理模块是系统的核心功能，用于统一管理和组织您的应用服务。通过项目管理，您可以：

- 创建和管理多个项目，每个项目可包含多个服务
- 支持三种服务类型：Application（应用服务）、Database（数据库服务）、Image（镜像服务）
- 实时监控服务运行状态和资源使用情况
- 统一管理服务的网络配置、域名访问和端口映射
- 从 Kubernetes 集群导入现有服务

---

## 一、项目列表页

### 1.1 功能概览

项目列表页是系统的主入口，展示所有项目的概览信息。

**主要功能：**
- 查看所有项目及其基本信息
- 快速统计项目总数、服务总数
- 搜索和排序项目
- 创建、编辑、删除项目

### 1.2 页面布局

**顶部操作区：**
- **新建项目**：点击右上角"新建项目"按钮创建新项目
- **系统配置**：访问系统级配置（如 GitLab、Jenkins、Kubernetes 等）

**统计卡片：**
- **项目总数**：当前系统中的项目数量
- **服务总数**：所有项目下的服务实例总数

**搜索与排序：**
- **搜索框**：支持按项目名称或项目编号搜索（实时搜索，300ms 防抖）
- **排序选项**：
  - 按创建时间（最新优先/最早优先）
  - 按名称（A-Z / Z-A）

**项目列表表格：**

| 列名 | 说明 |
|------|------|
| 项目 | 项目名称和唯一标识符（identifier） |
| 描述 | 项目的详细描述信息 |
| 服务数量 | 该项目下的服务总数 |
| 创建时间 | 项目创建的具体时间和相对时间 |
| 最近更新 | 项目最后更新的时间 |
| 常规操作 | 进入详情、编辑、删除等操作 |

### 1.3 创建项目

**步骤：**

1. 点击右上角"新建项目"按钮
2. 填写项目信息：
   - **项目名称**（必填）：项目的显示名称，支持中英文
   - **项目编号**（必填）：用于系统内部标识和域名访问的唯一标识
     - 仅支持小写字母、数字和中划线（-）
     - 不能以中划线开头或结尾
     - 长度限制：1-63 个字符
     - 示例：`xuanwu-app`、`user-service`
   - **项目描述**（可选）：项目的详细说明
3. 点击"创建"按钮

**注意事项：**
- 项目编号创建后可以修改，但会影响通过子域名访问的地址
- 系统会自动创建对应的 Kubernetes Namespace（命名空间）

### 1.4 编辑项目

**步骤：**

1. 在项目列表中，点击项目行右侧的"更多操作"按钮（三个点图标）
2. 选择"编辑"
3. 修改项目信息
4. 点击"保存"

**可修改内容：**
- 项目名称
- 项目编号（谨慎修改，会影响域名访问）
- 项目描述

### 1.5 删除项目

**步骤：**

1. 在项目列表中，点击项目行右侧的"更多操作"按钮
2. 选择"删除"
3. 在确认对话框中确认删除

**警告：**
- 删除项目会同时删除该项目下的所有服务
- 此操作不可恢复，请谨慎操作

---

## 二、项目详情页

### 2.1 功能概览

项目详情页展示单个项目的完整信息，包括项目下的所有服务及其运行状态。

**主要功能：**
- 查看项目基本信息和服务统计
- 管理项目下的所有服务（创建、编辑、删除、重启）
- 从 Kubernetes 导入现有服务
- 实时查看服务运行状态
- 通过域名快速访问服务

### 2.2 页面布局

**页面头部：**
- **返回按钮**：返回项目列表
- **项目信息**：
  - 项目名称和标识符
  - 项目描述
- **操作按钮**：
  - 创建服务（Application / Database / Image）
  - 从 K8s 导入
  - 项目操作（编辑项目、删除项目）

**服务统计卡片：**
- 总服务数
- Application 服务数
- Database 服务数
- Image 服务数

**筛选与搜索区：**
- **搜索框**：按服务名称搜索
- **类型筛选**：筛选特定类型的服务（全部/Application/Database/Image）
- **排序选项**：
  - 按名称（升序/降序）
  - 按更新时间（最近更新/最早更新）
- **刷新状态**：手动刷新服务的 Kubernetes 运行状态

**服务列表表格：**

| 列名 | 说明 |
|------|------|
| 服务 | 服务名称、类型、配置信息（仓库/镜像/数据库类型）、域名访问链接 |
| 状态 | 服务运行状态（运行中/待启动/已停止/错误/构建中） |
| 副本 | 服务实例副本数（仅 Application 和 Image 类型） |
| 网络/端口 | 服务的端口配置信息 |
| 最近更新 | 服务最后更新时间 |
| 操作 | 重启、删除等操作 |

### 2.3 创建服务

#### 2.3.1 创建 Application 服务

Application 服务用于部署基于 Git 仓库的应用程序。

**步骤：**

1. 点击"创建服务"按钮，选择"Application"
2. 填写基本信息：
   - **服务名称**：服务的显示名称
   - **Git 仓库地址**：应用代码的 Git 仓库 URL
   - **分支名称**：要部署的分支（如 `main`、`develop`）
   - **端口号**：应用监听的端口
   - **副本数**：服务实例数量（默认 1）
3. 配置构建选项（可选）：
   - Dockerfile 路径
   - 构建参数
4. 配置网络（可选）：
   - 域名配置
   - 端口映射
5. 点击"创建"

**适用场景：**
- Web 应用
- API 服务
- 微服务应用

#### 2.3.2 创建 Database 服务

Database 服务用于部署数据库实例。

**步骤：**

1. 点击"创建服务"按钮，选择"Database"
2. 填写基本信息：
   - **服务名称**：数据库服务名称
   - **数据库类型**：选择数据库类型（MySQL、PostgreSQL、MongoDB 等）
   - **版本**：数据库版本号
   - **内部端口**：容器内数据库监听端口
   - **外部端口**（可选）：对外暴露的端口
3. 配置数据库参数（可选）：
   - 数据库名称
   - 用户名和密码
   - 存储配置
4. 点击"创建"

**适用场景：**
- 关系型数据库（MySQL、PostgreSQL）
- NoSQL 数据库（MongoDB、Redis）
- 缓存服务

#### 2.3.3 创建 Image 服务

Image 服务用于直接部署 Docker 镜像。

**步骤：**

1. 点击"创建服务"按钮，选择"Image"
2. 填写基本信息：
   - **服务名称**：服务显示名称
   - **镜像名称**：Docker 镜像名称（如 `nginx`、`redis`）
   - **镜像标签**：镜像版本标签（如 `latest`、`1.21`）
   - **副本数**：服务实例数量
3. 配置网络（可选）：
   - 端口映射
   - 域名配置
4. 点击"创建"

**适用场景：**
- 第三方服务（Nginx、Redis、RabbitMQ 等）
- 已构建好的镜像
- 无需源码构建的服务

### 2.4 从 Kubernetes 导入服务

如果您的 Kubernetes 集群中已有运行的服务，可以将其导入到系统中进行管理。

**步骤：**

1. 点击"从 K8s 导入"按钮
2. 系统会自动扫描当前项目命名空间下的 Kubernetes 资源
3. 选择要导入的服务
4. 确认导入

**支持导入的资源类型：**
- Deployment
- StatefulSet
- Service
- Ingress

### 2.5 服务操作

#### 2.5.1 查看服务详情

点击服务列表中的任意服务行，进入服务详情页，可以查看：
- 服务的完整配置信息
- 容器运行日志
- 资源使用情况（CPU、内存）
- 部署历史
- 网络配置

#### 2.5.2 重启服务

**步骤：**

1. 点击服务行右侧的"更多操作"按钮（三个点图标）
2. 选择"重启"
3. 系统会重新部署该服务的所有 Pod

**适用场景：**
- 服务出现异常需要重启
- 配置更新后需要重启生效

#### 2.5.3 删除服务

**步骤：**

1. 点击服务行右侧的"更多操作"按钮
2. 选择"删除"
3. 在确认对话框中确认删除

**警告：**
- 删除服务会同时删除 Kubernetes 中的相关资源
- 此操作不可恢复，请谨慎操作

### 2.6 服务状态说明

| 状态 | 颜色 | 说明 |
|------|------|------|
| 运行中 | 绿色 | 服务正常运行 |
| 待启动 | 黄色 | 服务正在启动中 |
| 已停止 | 灰色 | 服务已停止 |
| 错误 | 红色 | 服务运行出错 |
| 构建中 | 蓝色 | 服务正在构建镜像 |

### 2.7 域名访问

对于 Application 和 Image 类型的服务，如果配置了域名，会在服务列表中显示域名访问链接。

**访问方式：**
- 点击服务信息下方的域名链接按钮
- 在新标签页中打开服务的 Web 界面

**域名格式：**
- 通常为：`http://<服务域名>`
- 如果配置了 HTTPS，则为：`https://<服务域名>`

---

## 三、常见问题

### 3.1 项目编号有什么作用？

项目编号（identifier）是项目的唯一标识符，主要用于：
- Kubernetes 命名空间名称
- 子域名访问地址的一部分
- 系统内部资源隔离

### 3.2 如何修改服务配置？

目前需要进入服务详情页进行配置修改。在服务列表中点击服务名称，进入详情页后可以编辑服务的各项配置。

### 3.3 服务状态一直显示"待启动"怎么办？

可能的原因：
1. 镜像拉取失败：检查镜像名称和标签是否正确
2. 资源不足：检查 Kubernetes 集群资源是否充足
3. 配置错误：检查服务配置（端口、环境变量等）是否正确

**解决方法：**
- 点击"刷新状态"按钮更新状态
- 进入服务详情页查看日志和事件
- 尝试重启服务

### 3.4 如何删除项目但保留服务？

目前系统不支持此操作。删除项目会同时删除其下的所有服务。如需保留服务，建议：
1. 先将服务迁移到其他项目
2. 或在 Kubernetes 中手动备份相关资源

### 3.5 服务副本数有什么作用？

副本数决定了服务运行的实例数量：
- **副本数 = 1**：单实例运行，适合开发测试环境
- **副本数 > 1**：多实例运行，提供高可用和负载均衡，适合生产环境

**注意：** Database 类型的服务通常不支持多副本（需要特殊配置）。

---

## 四、最佳实践

### 4.1 项目组织建议

- **按业务模块划分项目**：将相关的服务组织在同一个项目下
- **使用清晰的命名规范**：项目编号使用小写字母和中划线，如 `user-service`、`order-system`
- **添加详细的项目描述**：方便团队成员理解项目用途

### 4.2 服务管理建议

- **合理设置副本数**：开发环境使用 1 个副本，生产环境根据负载设置多个副本
- **配置健康检查**：确保服务异常时能够自动重启
- **使用域名访问**：为对外服务配置域名，便于访问和管理
- **定期查看日志**：及时发现和解决问题

### 4.3 安全建议

- **不要在项目描述中包含敏感信息**：如密码、密钥等
- **数据库服务不要暴露外部端口**：除非确实需要外部访问
- **定期更新服务镜像**：修复安全漏洞

---

## 五、快速操作指南

### 5.1 创建一个完整的项目

1. 在项目列表页点击"新建项目"
2. 填写项目名称（如"用户管理系统"）和编号（如"user-system"）
3. 创建 Database 服务（如 MySQL）
4. 创建 Application 服务（后端 API）
5. 创建 Application 服务（前端应用）
6. 配置服务间的网络连接
7. 为前端应用配置域名访问

### 5.2 快速部署一个 Nginx 服务

1. 进入项目详情页
2. 点击"创建服务" → "Image"
3. 填写：
   - 服务名称：`nginx`
   - 镜像名称：`nginx`
   - 镜像标签：`latest`
   - 端口：`80`
4. 配置域名（可选）
5. 点击"创建"

### 5.3 从 Git 仓库部署应用

1. 进入项目详情页
2. 点击"创建服务" → "Application"
3. 填写：
   - 服务名称：应用名称
   - Git 仓库地址：`https://github.com/your-org/your-repo.git`
   - 分支名称：`main`
   - 端口：应用监听端口（如 `3000`）
4. 配置 Dockerfile 路径（如果不在根目录）
5. 点击"创建"
6. 系统会自动触发构建和部署

---

## 六、技术支持

如遇到问题或需要帮助，请：
1. 查看服务详情页的日志和事件信息
2. 检查系统配置是否正确（GitLab、Jenkins、Kubernetes 连接）
3. 联系系统管理员或技术支持团队

---

**文档版本：** v1.0  
**最后更新：** 2024-12-01
